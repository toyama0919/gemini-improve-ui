# Gemini Improve UI

Chrome extension to improve Google Gemini Web UI with keyboard shortcuts and customizable chat width.

## Quick Start Debugging

```bash
./dev.sh start         # Start debug Chrome in background
curl http://localhost:9222/json/list  # Verify connection
./dev.sh stop          # Stop when done
```

MCP is pre-configured in `.cursor/mcp.json`. Use `list_pages()`, `take_snapshot()`, `evaluate_script()` tools.

## File Structure

- `src/content.js` - Entry point, CSS injection
- `src/keyboard.js` - Keyboard event handling
- `src/chat.js` - Chat operations
- `src/settings.js` - Settings management
- `options.html/js` - Settings UI

## Key Coding Rules

### Selector Priority
1. `data-test-id` (most stable)
2. ARIA attributes (`aria-label`, `role`)
3. Semantic attributes
4. Class names (last resort)

Always provide fallback selectors:
```javascript
const el = document.querySelector('[data-test-id="foo"]') ||
           document.querySelector('[aria-label*="Foo"]') ||
           document.querySelector('.foo');
```

### Settings Management
1. Add default in `settings.js`
2. Add UI in `options.html`
3. Add load/save in `options.js`
4. Use `chrome.storage.sync`

### Async Element Waiting
Use `setInterval` with max attempts (10) and timeout (200ms-2000ms).

### Error Handling
Fail silently. No console spam. Graceful degradation.

## DOM Changes
When Gemini UI changes:
1. Press `Ctrl+Shift+D` to export DOM
2. Ask AI for new selectors
3. Add fallback selectors in priority order

## Common Issues

**MCP fails**: Check Node 20.19.0+, restart Chrome/Cursor
**Shortcuts don't work**: Reload extension at `chrome://extensions/`
**Styles not applied**: Check `--chat-max-width` in DevTools, hard reload

## AI Development Tips

Share DOM structure (`Ctrl+Shift+D`), error messages, and expected behavior. Ask specific questions like "What selector for X in this DOM?"
